矩阵理论的课上笔记整理。

------

# 2022-03-08-矩阵理论01-预备知识1

### 复数

两个定义域：实数域$\mathbb{R}$（对应实轴），复数域$\mathbb{C}$（对应复平面）。
$$
\mathbb{C}\overset{def}{=}\{z=x+iy \mid i=\sqrt{-1},\enspace x,y\in\mathbb{R}\}
$$

$$
复数(z=x+iy)\Longleftrightarrow 点(x,y)\Longleftrightarrow 向量(x,y)^\top \enspace 一一对应，互相确定
$$

- 共轭：$\overline{z}=x-iy$
- 模长：$\lvert z \rvert=\sqrt{x^2+y^2}=z\overline{z}=\overline{z}z$
- 逆：$z^{-1}=\frac{\overline{z}}{\lvert z \rvert}$

模长的性质：

- 齐性：$\lvert kz \rvert=\lvert k \rvert \lvert z \rvert,k\in\mathbb{C}$
- 三角不等式：$\lvert w+z \rvert \le \lvert w \rvert + \lvert z \rvert$

### 复向量

实数域$\mathbb{R}$产生实向量空间$\mathbb{R}^n\overset{def}{=}\{x=\begin{pmatrix}x_1\\x_2\\\vdots\\x_n\end{pmatrix} \mid x_1,x_2 \cdots x_n \in \mathbb{R}\}$;

复数域$\mathbb{C}$产生复向量空间$\mathbb{C}^n\overset{def}{=}\{z=\begin{pmatrix}z_1\\z_2\\\vdots\\z_n\end{pmatrix} \mid z_1,z_2 \cdots z_n \in \mathbb{C}\}$。

（$\mathbb{R}^n、\mathbb{C}^n$多用于列向量格式，可用$\mathbb{R}_n、\mathbb{C}_n$表示行向量。）

##### 共轭转置

在转置的基础上再做共轭。

对于复数域上的列向量$x$，引入记号：$\overline{x}=(\overline{x_1},\overline{x_2}\cdots\overline{x_n})^\top$,

其共轭转置$x^H={(\overline{x})}^\top=(\overline{x_1},\overline{x_2}\cdots\overline{x_n})$。

共轭转置的性质：

- 自反性：$(x^H)^H=x$
- 可加性：$(x\pm y)^H=x^H\pm y^H$
- 齐性：$(kx)^H=kx^H,k\in\mathbb{C}$

##### 复向量的模

对于任一复向量$x=(x_1,x_2 \cdots x_n)^\top\in\mathbb{C}^n$

模长记为：$\lvert x \rvert=\sqrt{\lvert x_1 \rvert ^2+\lvert x_2 \rvert ^2+\cdots+\lvert x_n \rvert ^2}$

模长的性质：

- 正性：$\lvert x \rvert\ge0,\lvert x \rvert=0\Leftrightarrow x=\boldsymbol{0}$
- 齐性：$\lvert kz \rvert=\lvert k \rvert \lvert z \rvert,k\in\mathbb{C},x\in\mathbb{C}^n$
- 三角不等式：$\lvert x+y \rvert \le \lvert x \rvert + \lvert y \rvert$

模公式：$x^Hx=\lvert x \rvert ^2$
$$
x^Hx=\overline{x_1}x_1+\overline{x_2}x_2+\cdots+\overline{x_n}x_n=\lvert x_1 \rvert ^2+\lvert x_2 \rvert ^2+\cdots+\lvert x_n \rvert ^2=\lvert x \rvert ^2
$$

$$
xx^H=
\begin{pmatrix}
 x_1\overline{x_1} & x_1\overline{x_2} & \cdots & x_1\overline{x_n}\\
 x_2\overline{x_1} & x_2\overline{x_2} & \cdots & x_2\overline{x_n}\\
 \vdots & \vdots & \ddots & \vdots\\
 x_n\overline{x_1} & x_n\overline{x_2} & \cdots & x_n\overline{x_n}
\end{pmatrix}
$$

求迹：$traj(xx^H)=x_1\overline{x_1}+x_2\overline{x_2}+\cdots+x_n\overline{x_n}=\lvert x \rvert ^2$

拓展的模公式：$traj(xx^H)=traj(x^Hx)=\lvert x \rvert ^2$

### 复矩阵

复$m\times n$矩阵空间：$\mathbb{C}^{m\times n}\overset{def}{=}\{A=(a_{ij})_{m\times n} \mid a_{ij}\in\mathbb{C}\}$

##### 共轭转置

$A=(a_{ij})_{m\times n}\in\mathbb{C}^{m\times n}$

$A^H={(\overline{A})}^\top=((\overline{a_{ij}})_{m\times n})^\top\in\mathbb{C}^{n\times m}$

共轭转置的性质：

- 自反性：$(A^H)^H=A$
- 可加性：$(A\pm B)^H=A^H\pm B^H$
- 齐性：$(kA)^H=kA^H,k\in\mathbb{C}$

##### 复矩阵的模

$\parallel A \parallel = \sqrt{\sum \lvert a_{ij} \rvert ^2}$

模长的性质：

- 正性：$\lvert A \rvert\ge0,\lvert A \rvert=0\Leftrightarrow A=\boldsymbol{0}$
- 齐性：$\lvert kA \rvert=\lvert k \rvert \lvert A \rvert,k\in\mathbb{C},A\in\mathbb{C}^{m\times n}$

模公式：$traj(AA^H)=traj(A^HA)=\parallel A \parallel ^2=\sum \lvert a_{ij} \rvert ^2$

证明矩阵的模公式：

$A=(a_{ij})_{m\times n}=(\alpha_1,\alpha_2\cdots\alpha_n)$，各$\alpha$为列向量。
$$
A^H=\begin{pmatrix}\alpha_1^H\\\alpha_2^H\\\vdots\\\alpha_n^H\end{pmatrix}\Rightarrow A^HA=
\begin{pmatrix}
 \alpha_1^H\alpha_1 & \cdots & \cdots & \alpha_1^H\alpha_n\\
 \vdots & \alpha_2^H\alpha_2 &  & \vdots\\
 \vdots &  & \ddots  & \vdots\\
 \alpha_n^H\alpha_1 & \cdots & \cdots & \alpha_n^H\alpha_n
\end{pmatrix}
$$
$traj(A^HA)=\lvert \alpha_1 \rvert ^2+\lvert \alpha_2 \rvert ^2+\cdots+\lvert \alpha_n \rvert ^2=\sum \lvert a_{ij} \rvert ^2=\parallel A \parallel ^2$

$traj(AA^H)$同理。

### 例子

1. 已知$A^HA=\boldsymbol{0}$，则$A^H=\boldsymbol{0}$。

   证明：$\parallel A \parallel ^2=traj(A^HA)=traj(\boldsymbol{0})=0\Rightarrow A=\boldsymbol{0},A^H=\boldsymbol{0}$

2. $(AB)^H=B^HA^H$。

   证明：$(AB)^H=(\overline{AB})^\top={\overline{B}}^\top{\overline{A}}^\top=B^HA^H$

   推论：对于方阵而言：$(A^k)^H=(A^H)^k,k\in\mathbb{N}$

------

# 2022-03-10-矩阵理论02-预备知识2

### 复向量的标准内积

$\mathbb{C}^n$中标准内积记为：$(x,y)=(x|y)=\mid x,y\in\mathbb{C}^n$

$(x,y)=x_1\overline{y_1}+x_2\overline{y_2}+\cdots+x_n\overline{y_n}$

内积的性质：（具有这四条性质就可以称为内积，即可以定义一些非标准内积）

- 正性：$(x,x)\ge0,(x,x)=0 \Leftrightarrow x=\boldsymbol{0}$
- (共轭)齐性：$(kx,y)=k(x,y),(x,ky)=\overline{k}(x,y),k\in\mathbb{C}$
- (共轭)对称性：$(x,y)=\overline{(y,x)}$
- 可加性：$(x+w,y)=(x,y)+(w,y),(y,x+w)=(y,x)+(y,w)$

由标准内积定义的标准模长：

$\lvert x \rvert=\sqrt{(x,x)}=\sqrt{\lvert x_1 \rvert ^2 + \lvert x_2 \rvert ^2+\cdots+\lvert x_n \rvert ^2}$

标准模长的性质：

- 正性：$\lvert x \rvert\ge0,\lvert x \rvert=0 \Leftrightarrow x=\boldsymbol{0}$
- 齐性：$\lvert kx \rvert=k\lvert x \rvert$
- 单位向量：$\frac{x}{\lvert x \rvert}$

##### 内积空间

设$v$是一个线性空间，有二元复函数$(x,y)$满足上述的四条性质，则把该二元运算称为$v$上的一个内积，把$v$称为内积空间。

例如令$v=\mathbb{C}^{m\times n}$，可引入内积$(A,B)=\sum a_{ij}\overline{b_{ij}} \mid A,B\in \mathbb{C}^{m\times n}$，满足内积的四条性质。

### 正交复向量

$\mathbb{C}^n$中正交向量记为：$x\perp y$

定义为：$(x,y)=0\Leftrightarrow x\perp y$

正交复向量的性质：

- 对称性：$x\perp y\Leftrightarrow y\perp x$

- 齐性：若$x\perp y$，则$ax\perp by \mid a,b\in\mathbb{C}$，因为$(ax,by)=a\overline{b}(x,y)=0$

- 勾股公式：若$x\perp y$，则$\lvert x+y \rvert ^2=\lvert x \rvert ^2 + \lvert y \rvert ^2$

  证明：$\lvert x+y \rvert ^2=xx+xy+yx+yy=\lvert x \rvert ^2 + \lvert y \rvert ^2$

  推广：若$x_1\perp x_2\perp\cdots\perp x_n$，则：
  $$
  \lvert k_1x_1+k_2x_2+\cdots+k_nx_n \rvert ^2=\lvert k_1 \rvert ^2\lvert x_1 \rvert ^2+\lvert k_2 \rvert ^2\lvert x_2 \rvert ^2+\cdots+\lvert k_n \rvert ^2\lvert x_n \rvert ^2
  $$

- 非零正交组必线性无关（利用线性无关的定义证明）

------

# 2022-03-15-矩阵理论03-引入酉阵

### 格拉姆矩阵

若有$p$个列$(x_1,x_2\cdots x_p)$在$\mathbb{C}^n$中，令$A=(x_1,x_2\cdots x_p)\in\mathbb{C}^{n\times p}$，令：

$$
G\overset{def}{=}
\begin{pmatrix}
 (x_1,x_1) & \cdots & \cdots & (x_1,x_p)\\
 \vdots & (x_2,x_2) &  & \vdots\\
 \vdots &  & \ddots  & \vdots\\
 (x_p,x_1) & \cdots & \cdots & (x_p,x_p)
\end{pmatrix}
$$
称为这$p$个列向量的格拉姆矩阵（内积方阵）；又：
$$
A^HA=\begin{pmatrix}x_1^H\\x_2^H\\\vdots\\x_p^H\end{pmatrix}
(x_1^H,x_2^H\cdots x_p^H)=
\begin{pmatrix}
 x_1^Hx_1 & \cdots & \cdots & x_1^Hx_p\\
 \vdots & x_2^Hx_2 &  & \vdots\\
 \vdots &  & \ddots  & \vdots\\
 x_p^Hx_1 & \cdots & \cdots & x_p^Hx_p
\end{pmatrix}
$$
由$x^Hy=(y,x)=\overline{(x,y)}$
$$
A^HA=
\begin{pmatrix}
 \lvert x_1 \rvert^2 & \cdots & \cdots & \overline{(x_1,x_p)}\\
 \vdots & \lvert x_2 \rvert^2 &  & \vdots\\
 \vdots &  & \ddots  & \vdots\\
 \overline{(x_p,x_1)} & \cdots & \cdots & \lvert x_p \rvert^2
\end{pmatrix}
=\overline{G}
$$

同理，如果取的是$p$个行，可以推出：$AA^H=G$（行内积方阵，行格拉姆矩阵）。

### 酉阵的引入

显然，如果$\mathbb{C}^n$中的$p$个列$(x_1,x_2\cdots x_p)$互相正交，那么$A^HA$为$p$阶对角方阵。

##### 酉阵

酉阵定义：若$n$阶方阵$A=(\alpha_1,\alpha_2\cdots\alpha_n)$符合下列中的某一定义，则将$A$称为$n$阶酉阵。

- 定义1：$\alpha_1\perp \alpha_2\perp\cdots\perp \alpha_n,\lvert \alpha_1 \rvert=\lvert \alpha_2 \rvert=\cdots=\lvert \alpha_n \rvert=1$
- 定义2：$A^HA=AA^H=I_n$
- 定义3：$A^H=A^{-1}$

酉阵的性质：$(\alpha_1,\alpha_2\cdots\alpha_n)$构成酉阵$A$，则：

- 这些列的新排列$(\alpha_{\beta_1},\alpha_{\beta_2}\cdots\alpha_{\beta_n})$构成酉阵。

- 取单位复数$\lvert \varepsilon_1 \rvert=\lvert \varepsilon_2 \rvert=\cdots=\lvert \varepsilon_n \rvert=1$，则$(\varepsilon_1\alpha_1,\varepsilon_2\alpha_2\cdots\varepsilon_n\alpha_n)$构成酉阵。

- 保长性：$\parallel Ax \parallel=\parallel x \parallel,x\in\mathbb{C}^n$(相当于一个转动或镜像)。

  证明：$\parallel Ax \parallel^2=(Ax)^HAx=x^HA^HAx=x^HIx=x^Hx=\parallel x \parallel^2$

- 保内积：$(Ax,Ay)=(x,y)$（相当于保夹角）。

  证明：$(Ax,Ay)=(Ay)^HAx=y^HA^HAx=y^Hx=(x,y)$

- 保正交：若$x\perp y$，则$Ax\perp Ay$。

- 保正交组：$x_1\perp x_2\perp\cdots\perp x_n$，则$Ax_1\perp Ax_2\perp\cdots\perp Ax_n$。

- 保正交基：保持正交基（$n$维空间中的$n$个互正交向量）、标准正交基（长度都为1的正交基）。

- 乘法封闭性：$A,B$为同阶酉阵，则$AB$为酉阵。

  证明：$(AB)^{-1}=B^{-1}A^{-1}=B^HA^H=(AB)^H$

  或者用酉阵的保正交组性和保长性证明（将$B$视为一组列向量）。
  
- 分块酉阵：若$A,B$为酉阵，则：$\begin{pmatrix}A&0\\0&B\end{pmatrix}$为酉阵。

正交矩阵就是实酉阵。


##### 预酉阵

预酉阵定义：若$n$阶方阵$A=(\alpha_1,\alpha_2\cdots\alpha_n)$满足$\alpha_1\perp \alpha_2\perp\cdots\perp \alpha_n$，则称$A$为$n$阶预酉阵。

$n$阶方阵$A$为预酉阵$\Leftrightarrow$$A^HA$为对角阵。

##### 半酉阵

若$p$行矩阵$A=(\alpha_1,\alpha_2\cdots\alpha_n)(p\ge n)$满足$\alpha_1\perp \alpha_2\perp\cdots\perp \alpha_n,\lvert \alpha_1 \rvert=\lvert \alpha_2 \rvert=\cdots=\lvert \alpha_n \rvert=1$，

则称$A$为半酉阵/列酉阵。半酉阵也有保长性、保内积、保正交、保正交组的性质，因为是把低维空间映射到高维。

------

# 2022-03-17-矩阵理论04-许尔公式

这次课开头补充了一些酉阵相关内容，这部分合并到上一节了。

### 引理

$\mathbb{C}^n$中的一个非零向量$\alpha$可扩大为一组基：$\alpha_1,\alpha_2,\cdots,\alpha_n$。

$\mathbb{C}^n$中的一个非零向量$\alpha$可扩大为一组正交基：$\alpha_1\perp\alpha_2\perp\cdots\perp\alpha_n$。

可以先扩大为一组基（$\mathbb{C}^n$中$n$个线性无关的向量），再用施密特正交化转化为正交基。



令$P=P_{n\times n}$可逆，$P=(x_1,x_2,\cdots,x_n)$（各列）

则$P^{-1}x_1=e_1,P^{-1}x_2=e_2,\cdots,P^{-1}x_n=e_n$。

因为$P^{-1}P=I_n=(e_1,e_2,\cdots,e_n)$且$P^{-1}P=(P^{-1}x_1,P^{-1}x_2,\cdots,P^{-1}x_n)$。

### 许尔公式

##### 许尔公式2

对于任一方阵$A=A_{n\times n}$，存在酉阵$Q$使得：
$$
Q^{-1}AQ=D=
\begin{pmatrix}
 \lambda_1 &  &  & *\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
为上三角阵，且$\lambda(A)=(\lambda_1,\lambda_2,\cdots,\lambda_n)$为$A$的全体特征根（即方阵$A$相似于上三角阵$D$，三角阵的特征值就是对角线元素）。

证明是利用数学归纳法，详见赵迪老师发的许尔公式2.pdf。

这里也称$A$酉相似于$D$。

##### 许尔公式1

对于任一方阵$A=A_{n\times n}$，存在可逆阵$P$使得：
$$
P^{-1}AP=D=
\begin{pmatrix}
 \lambda_1 &  &  & *\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
为上三角阵，且$\lambda(A)=(\lambda_1,\lambda_2,\cdots,\lambda_n)$为$A$的全体特征根（即方阵$A$相似于上三角阵$D$，三角阵的特征值就是对角线元素）。

证明同样是利用数学归纳法，详见赵迪老师发的许尔公式1.pdf。

许尔公式1弱于许尔公式2。

------

# 2022-03-22-矩阵理论05-Jordan标准形、秩

常见记号：

令$n$阶方阵$A=A_{n\times n}\in \mathbb{C}^{n\times n}$，$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$为$A$的全体特征根（含重复根）。

$\rho(A)=\max \{|\lambda_1|,|\lambda_2|,\cdots,|\lambda_n|\}$为$A$的谱半径。

$A$的特征多项式$T(\lambda)=|\lambda I_n-A|$必有分解式：$T(\lambda)=(\lambda-\lambda_1)(\lambda-\lambda_2)\cdots(\lambda-\lambda_n)$。

且有开来(Caylay)公式：$T(A)=(A-\lambda_1 I)(A-\lambda_2 I)\cdots(A-\lambda_n I)=\boldsymbol{0}$。

### 引出Jordan标准形

许尔公式1中的可逆矩阵不唯一，可以找到更好的$P$使得：
$$
P^{-1}AP=J=
\begin{pmatrix}
 \lambda_1 & * &  & 0\\
   & \lambda_2 & * & \\
   &  & \ddots & *\\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
为双线上三角阵，其中$*=0/1$，且重复特征根写在一起。

这里的$J$称为Jordan（若当）标准形，每个特征根对应的矩阵块称为Jordan（若当）块。

特别地：当$*$全为0时$J$为对角形，$A$称为可对角化阵（单纯阵）。

### 矩阵的秩

##### 秩的定义

$rank(A),r(A),A=A_{m\times n}\in \mathbb{C}^{m\times n}$，有多种定义，形式不同但数值相同。

**从子式的角度定义**

$k$阶子式：对$m\times n$矩阵，任取$k$行和$k$列$(k\le\min(m,n))$，不改变它们在矩阵中的位置次序，构成的$k$阶行列式，称为矩阵的$k$阶子式。

如果矩阵中有非零的$r$阶子式且没有非零的$r+1$阶子式，则矩阵的秩为$r$。

**从极大线性无关组的角度定义**

将矩阵按行分解为$n$个向量，组成一个向量组。则该向量组的一个最大线性无关组中包含向量的个数$r$称为矩阵的行秩。同理可定义列秩，可证列秩等于行秩。

齐次方程组$Ax=0$的解空间$N(A)=\{x|Ax=0,x\in \mathbb{C}^n\}$有维数公式：$dim(N(A))=n-r$。

即$Ax=0$恰有$n-r$个基本解（线性无关）$\varepsilon_1,\varepsilon_2\cdots\varepsilon_{n-r}$，且通解为：$x=t_1\varepsilon_1+t_2\varepsilon_2+\cdots+t_{n-r}\varepsilon_{n-r}$。

##### 相关公式

**秩公式**

$\forall A=A_{m\times n}$，$r(A^HA)=r(A),r(AA^H)=r(A)$

证明：$(A^HA)x=0$与$Ax=0$同解，所以解空间维数一定相同，$r(A^HA)=r(A)$，用$A^H$代换$A$，则：

$r(AA^H)=r(A^H)=r({(\overline{A})}^\top)=r(\overline{A})=r(A)$。

**秩定理**

$r(AB)\le\min\{r(A),r(B)\}$

### 相似

相似的定义：若$A,B$为同阶方阵，若存在可逆矩阵$P$使得：$P^{-1}AP=B$记为$A\sim B$。

相似的性质：

- 自反性：$A\sim A$

- 对称性：$A\sim B\Leftrightarrow B\sim A$

- 传递性：$A\sim B,B\sim C\Rightarrow A\sim C$

- 特征多项式：若$A\sim B$，则$|\lambda I-A|=|\lambda I-B|$，即特征多项式相同，特征值相同。

- 幂的性质：若$A\sim B$，则$A^k\sim B^k,k\in N$，证明：

  $(P^{-1}AP)^k=(P^{-1}AP)(P^{-1}AP)\cdots(P^{-1}AP)=P^{-1}A^kP=B^k$

### 换位公式

若$A=A_{n\times p},B=B_{p\times n},p\le n$，则$AB$为$n$阶方阵，$BA$为$p$阶方阵，则有特征多项式：

$|\lambda I_n-AB|=(\lambda-\lambda_1)(\lambda-\lambda_2)\cdots(\lambda-\lambda_p)\lambda^{n-p}=\lambda^{n-p}|\lambda I_p-BA|$。

- 推论1：令$\lambda(BA)=\{\lambda_1,\lambda_2\cdots\lambda_p\}$则$\lambda(AB)=\{\lambda_1,\lambda_2\cdots\lambda_p,0\cdots0\}$（$n-p$个0，非零根完全重合）；

  特别地：若$n=p$，则$AB$与$BA$的特征根完全一致（说明特征根完全一致不一定需要两个矩阵相似）。

- 推论2：$traj(AB)=\lambda_1+\lambda_2+\cdots+\lambda_p=traj(BA)$。

### 秩1公式

换位公式当$p=1,n\ge 1$时，$A=A_{n\times 1},B=B_{1\times n}$，则$AB=\{ab_1,ab_2\cdots ab_n\}$，各列成比例，称为比例阵。

$BA=a_1b_1+a_2b_2+\cdots+a_nb_n=\lambda_1$，$\lambda(AB)=(\lambda_1,0\cdots 0)$，且$traj(AB)=traj(BA)=\lambda_1$。

秩1方阵：

若$A$为$n$阶方阵且$rank(A)=1$，则有：$A=\alpha\beta$，$\alpha$为列向量，$\beta$为行向量。（称为秩1分解）

秩1公式：

若$A=A_{n\times n}$的秩为1，则其特征根为$(\lambda_1,0\cdots 0)=(traj(A),0\cdots 0)$，由秩1分解和换位公式可以证明。

------

# 2022-03-24-矩阵理论06-特征值和特征向量

### 特征值和特征向量的性质

##### 平移法

将$A+cI$称为方阵$A$的平移。

若$n$阶方阵$A$的全体特征根（含重根）记为：$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$

- 平移法1：$A+cI$的全体特征根为：$\lambda(A+cI)=\{\lambda_1+c,\lambda_2+c\cdots\lambda_n+c\}$

  证明：$Ax=\lambda x\Rightarrow Ax+cIx=\lambda x+cx\Rightarrow (A+cI)x=(\lambda+c)x$

- 平移法2：$A+cI$与$A$有完全相同的特征向量

##### 倍法

$k\ne 0$的情况下，$n$阶方阵$A$的全体特征根（含重根）记为：$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$

- 倍法1：$kA$的全体特征根为：$\lambda(kA)=\{k\lambda_1,k\lambda_2\cdots k\lambda_n\}$
- 倍法2：$kA$与$A$有完全相同的特征向量

##### 幂法

$k\in N$，$n$阶方阵$A$的全体特征根（含重根）记为：$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$

- 幂法1：$A^k$的全体特征根为：$\lambda(A^k)=\{\lambda_1^k,\lambda_2^k\cdots\lambda_n^k\}$

- 幂法2：$A$的特征向量一定是$A^k$的特征向量（称为遗传法）

  证明：$A^2x=AAx=A\lambda x=\lambda Ax=\lambda\lambda x=\lambda^2x$，依次类推

更一般的遗传法：

$f(x)$为多项式，$n$阶方阵$A$的全体特征根（含重根）记为：$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$

- $f(A)$的全体特征根为：$\lambda(f(A))=\{f(\lambda_1),f(\lambda_2)\cdots f(\lambda_n)\}$
- $A$的特征向量一定是$f(A)$的特征向量

### 秩1矩阵的特征值和特征向量

- 设方阵$A=A_{n\times n}$秩为1，则$A$中的列（非0）都是$\lambda_1=traj(A)$的特征向量。

  证明：$r(A)=1$则必有分解：$A=\alpha\beta$（$\alpha$为非零列向量，$\beta$为非零行向量）

  $A\alpha=\alpha\beta\alpha=\alpha(\beta\alpha)=traj(A)\alpha=\lambda_1\alpha$

  故$\alpha$是$A$的特征向量，而$A$中的各列都是$\alpha$的倍数，所以$A$中的列是$\lambda_1$的特征向量。

- 方程组$\beta x=0$的$n-1$个基本解$y_1,y_2\cdots y_n$都恰为0根的特征向量。

  证明：若$x$为$\beta x=0$的一个非零解，则$Ax=(\alpha\beta)x=\alpha(\beta x)=\alpha 0=0x$

  所以$\beta x=0$的任意非零解都是0根的特征向量

### Hermite矩阵的特征值和特征向量

Hermite矩阵的定义：$A^H=A\in\mathbb{C}^{n\times n}$

引理：令$f(x)=x^HAx(A^H=A,x\in\mathbb{C}^n)$（称为Hermite二次型），则对于$\forall x\in\mathbb{C}^n$，$f(x)$只取实数。

证明：记$f=x^HAx$为复数（一阶矩阵），则：

$\overline{f}=(\overline{f})^{\top}=f^H=(x^HAx)^H=x^HA^H(x^H)^H=x^HAx=f$，故$f$为实数。

特征值：

若$A$为Hermite矩阵，则$A$的全体特征根为实数。

证明：任取$\lambda_1\in\lambda(A)$，$x$为$\lambda_1$的特征向量$(x\ne 0)$

$\lambda_1=\frac{x^HAx}{|x|^2}$（特商公式）

由引理可知分子为实数，而$|x|^2>0$，故$\lambda_1$为实数。

------

# 2022-03-29-矩阵理论07-Hermite矩阵的性质1

### Hermite分解定理

若$A^H=A\in\mathbb{C}^{n\times n}$（$n$阶Hermite阵），则存在$n$阶酉阵$Q$使得：
$$
Q^{-1}AQ=Q^HAQ=D=
\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
为对角形，其中$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$为实数。

证明：由许尔公式2，存在酉阵$Q$使得$Q^HAQ=Q^{-1}AQ=D$为上三角，则：

$(Q^HAQ)^H=D^H$为下三角，$D^H=(Q^HAQ)^H=Q^HA^HQ=Q^HAQ=D$，

故$D$为对角形且$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$为实数。

可写分解公式：
$$
A=QDQ^{-1}=QDQ^H=
Q\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}Q^H
$$

### 许尔估计

由许尔公式2：

$Q^{-1}(AA^H)Q=Q^H(AA^H)Q=Q^HAQQ^{-1}AQ=(Q^HAQ)(Q^HA^HQ)=DD^H$

即$AA^H\sim DD^H$（相似）

故$traj(AA^H)=traj(DD^H)$

可写方阵$A=(a_{ij})_{n\times n}\in \mathbb{C}^{n\times n}$，
$$
D=
\begin{pmatrix}
 \lambda_1 &  &  & *\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
由迹公式：$traj(AA^H)=traj(A^HA)=\sum |a_{ij}|^2$，

$traj(DD^H)=traj(D^HD)=|\lambda_1|^2+|\lambda_2|^2+\cdots+|\lambda_n|^2+\sum|*|^2$，故：

1. $|\lambda_1|^2+|\lambda_2|^2+\cdots+|\lambda_n|^2+\sum|*|^2=\sum |a_{ij}|^2$
2. $|\lambda_1|^2+|\lambda_2|^2+\cdots+|\lambda_n|^2\le\sum |a_{ij}|^2$（称为许尔估计）
3. 2中等号成立当且仅当$*=\boldsymbol{0}$即$D$为对角阵

### Hermite矩阵与特征向量

若$n$阶方阵$A$有$n$个线性无关的特征向量$x_1,x_2\cdots x_n$，令$P=(x_1,x_2\cdots x_n)$可逆，则有
$$
P^{-1}AP=D=
\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
定理：$A$有$n$个无关的特征向量$\Leftrightarrow$$A$相似于对角形$(P^{-1}AP=D)$，且$P$中列为$n$个特征向量。

- 推论1：若$A$为Hermite阵，则$A$酉相似于对角形

- 推论2：若$A$为Hermite阵，则$A$有$n$个正交的特征向量$x_1\perp x_2\perp\cdots\perp x_n$

  证明：由上一定理和酉阵列正交的性质可证

备注1：Hermite阵不同根的特征向量必正交。证明：

$Ax=\lambda_1 x,Ay=\lambda_2 y$

$\lambda_1(x,y)=(\lambda_1 x,y)=(Ax,y)=y^HAx$

$\lambda_2(x,y)=(x,\overline{\lambda_2}y)=(x,\lambda_2 y)=(x,Ay)=(Ay)^Hx=y^HA^Hx=y^HAx$

$\lambda_1(x,y)=\lambda_2(x,y)$且$\lambda_1\ne\lambda_2$，故$(x,y)=0$

备注2：若$A$为Hermite阵且$\lambda(A)=\{a,b\cdots b\}$且$Ax=ax(x\ne\boldsymbol{0}),x\perp y$，则$y$是$b$的特征向量。

### 构造Hermite阵

##### Hermite二次型

Hermite二次型记为$f=x^HAx(A=A^H,x\in\mathbb{C}^n)$

- $f=x^HAx$必为实数
- 若$\forall x\ne 0,f=x^HAx>0$，称$f$为正定的，$A$为正定(Hermite)阵，记为$A>0$
- 若$\forall x,f=x^HAx\ge 0$，称$f$为半正定的，$A$为半正定(Hermite)阵，记为$A\ge 0$

##### 构造半正定Hermite阵

$\forall A\in \mathbb{C}^{m\times n}$，有：

- $A^HA,AA^H$为Hermite阵

  证明：$(A^HA)^H=A^HA,(AA^H)^H=AA^H$

- $A^HA,AA^H$半正定

  证明：令二次型$f=X^H(A^HA)x$，$x$为列向量

  则$f=(Ax)^HAx=||Ax||^2\ge 0$，$AA^H$同理。

------

# 2022-03-31-矩阵理论08-Hermite矩阵的性质2

### 正定性与特征根的性质

若$A$为Hermite阵，则：

- $A$负定$\Leftrightarrow$$-A$正定
- 若$A$正定$\Leftrightarrow$则$A$的特征根全为正
- 若$A$半正定$\Leftrightarrow$则$A$的特征根非负

左向右证明：任取特征根$\lambda\in\{\lambda_1,\lambda_2\cdots\lambda_n\}$，取特征向量$x\ne \boldsymbol{0}$

由特商公式：$\lambda=\frac{x^HAx}{|x|^2}$，因为$x^HAx>0$，所以$\lambda>0$。

右向左证明：由上节的推论：若$A$为Hermite阵，则$A=A_{n\times n}$有$n$个正交的特征向量$x_1\perp x_2\perp\cdots\perp x_n$，

对这些特征向量进行单位化，$\xi_1=\frac{x_1}{|x_1|},\xi_2=\frac{x_2}{|x_2|}\cdots\xi_n=\frac{x_n}{|x_n|}$为$\mathbb{C}^n$中的一组正交基，

且$A\xi_1=\lambda_1\xi_1,A\xi_2=\lambda_2\xi_2,\cdots,A\xi_n=\lambda_n\xi_n$，

则内积$(A\xi_1,\xi_1)=\lambda_1,(A\xi_2,\xi_2)=\lambda_2,\cdots,(A\xi_n,\xi_n)=\lambda_n$且$(A\xi_i,\xi_j)=\lambda(\xi_i,\xi_j)=0(i\ne j)$

任取$x\in\mathbb{C}^n$，要证$x^HAx>0$，

可令$x=a_1\xi_1+a_2\xi_2+\cdots+a_n\xi_n$（基的定义）

$Ax=a_1\lambda_1\xi_1+a_2\lambda_2\xi_2+\cdots+a_n\lambda_n\xi_n$，

内积$(Ax,x)=\lambda_1|a_1|^2+\lambda_2|a_2|^2+\lambda_n|a_n|^2$

由于$\lambda_1,\lambda_2\cdots\lambda_n>0$，$a_1,a_2,\cdots,a_n$不全为0（由于$x\ne 0$)，所以$x^HAx>0=(Ax)x=(Ax,x)>0$。

### 正定性与分解

若$A$为正定Hermite阵，那么$A$可以分解为$A=P^HP$，且矩阵$P$可逆。

证明：由Hermite分解定理：
$$
A=
Q\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}Q^H
$$
其中$Q$为酉阵$(Q^{-1}=Q^H)$

且$\lambda_1>0,\lambda_2>0,\cdots,\lambda_n>0$，可写
$$
A=Q
\begin{pmatrix}
 \sqrt{\lambda_1} &  &  & 0\\
   & \sqrt{\lambda_2} &  & \\
   &  & \ddots & \\
 0 &  &  & \sqrt{\lambda_n}
\end{pmatrix}
\begin{pmatrix}
 \sqrt{\lambda_1} &  &  & 0\\
   & \sqrt{\lambda_2} &  & \\
   &  & \ddots & \\
 0 &  &  & \sqrt{\lambda_n}
\end{pmatrix}
Q^H
$$
令
$$
P=
\begin{pmatrix}
 \sqrt{\lambda_1} &  &  & 0\\
   & \sqrt{\lambda_2} &  & \\
   &  & \ddots & \\
 0 &  &  & \sqrt{\lambda_n}
\end{pmatrix}
Q^H
$$
该矩阵是两个可逆阵地乘积，一定可逆，则$A=P^HP$

反之也成立：若$A$为Hermite阵，$A=P^HP$且$P$可逆，则$A$正定

证明：由于$P$可逆，所以$\forall x\in\mathbb{C}^n\ne \boldsymbol{0}$，$Px\ne\boldsymbol{0}$

故$||Px||^2>0$

二次型$x^HAx=x^HP^HPx=(Px)^H(Px)=||Px||^2>0$

故$x^HAx$正定。

故若$A$为Hermite阵，那么$A$正定$\Leftrightarrow$$A$可以分解为$A=P^HP$，且矩阵$P$可逆。

半正定也有类似的结论：

故若$A$为Hermite阵，那么$A$半正定$\Leftrightarrow$$A$可以分解为$A=P^HP$（不要求矩阵$P$可逆）。

### 相合

若$P^HAP=B$且$P$矩阵可逆，则称$A$与$B$相合（合同），记$A\overset{\bigtriangleup}{=}B$。

- 相合保持Hermite阵（若$A$为Hermite阵则$P^HAP$（$P$为可逆阵）为Hermite阵）。
- 相合保持正定（若$A$为正定阵则$P^HAP$（$P$为可逆阵）为正定阵）。
- 相合具有传递性（$A\overset{\bigtriangleup}{=}B,B\overset{\bigtriangleup}{=}C\Rightarrow A\overset{\bigtriangleup}{=}C$）。

若$A$为Hermite阵，则：

$A>0$（正定）$\Leftrightarrow A\overset{\bigtriangleup}{=}I$（相合）

证明：$A>0\Leftrightarrow A=P^HP=P^HIP\Leftrightarrow A\overset{\bigtriangleup}{=}I$

### 平方根定理

若$A$为Hermite阵，$A>0$（正定）$\Rightarrow A=B^2$（$B>0$且$B$为Hermite阵），可记$B=\sqrt{A}$。

证明：由Hermite分解定理：
$$
A=QDQ^H=
Q\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}Q^H
$$
$Q$为酉阵，显然：
$$
\sqrt{D}=
\begin{pmatrix}
 \sqrt{\lambda_1} &  &  & 0\\
   & \sqrt{\lambda_2} &  & \\
   &  & \ddots & \\
 0 &  &  & \sqrt{\lambda_n}
\end{pmatrix}
$$
为Hermite阵，且$\sqrt{D}$正定，$(\sqrt{D})^2=\sqrt{D}\sqrt{D}=D$

可写$A=Q\sqrt{D}\sqrt{D}Q^H=Q\sqrt{D}Q^{-1}Q\sqrt{D}Q^H=(Q\sqrt{D}Q^H)(Q\sqrt{D}Q^H)$

令$B=Q\sqrt{D}Q^H$

则$B^H=(Q^H)^H(\sqrt{D})^HQ^H=Q\sqrt{D}Q^H=B$，即$B$为Hermite阵。

$\lambda(B)=\{\sqrt{\lambda_1},\sqrt{\lambda_2}\cdots\sqrt{\lambda_n}\}$全为正，故$B$正定。

同理：若$A$为Hermite阵，$A\ge0$（半正定）$\Rightarrow A=B^2$（$B\ge0$且$B$为Hermite阵）。

### QR分解

又称UR分解。

若$A$为列无关矩阵$A=A_{n\times p}$，则$A=QR$，$Q$为半酉阵$(Q^HQ=I)$，$R$为上三角阵。

其中$R=Q^{-1}A=Q^HA$。

QR分解可以用施密特正交化方法求$Q$，再用$R=Q^HA$求$R$。

##### 方阵的QR分解

n阶可逆方阵$A=A_{n\times n}$必有QR分解$A=QR$，其中$Q$为酉阵，
$$
R=
\begin{pmatrix}
 b_1 &  &  & *\\
   & b_2 &  & \\
   &  & \ddots & \\
 0 &  &  & b_n
\end{pmatrix}
$$
为上三角阵。

若分解时采用施密特正交化方法则$b_1,b_2\cdots b_n>0$

n阶不可逆方阵也有QR分解，其中$Q$为酉阵，$R$为上三角阵；

此时施密特正交化方法失效（施密特正交化方法要求可逆），可用镜面阵方法。

------

# 2022-04-07-矩阵理论09-矩阵分解

### 常见矩阵分解

- QR分解：$A=QR$，$Q$为酉阵，$R$为上三角阵。

- Hermite分解：$(A=A^H)$，$A=QDQ^H$，$Q$为酉阵，$D$为对角阵，对角元素为特征根。

- Jordan形分解：$A=A_{n\times n}=PJP^{-1}$，$P$为可逆矩阵，
  $$
  J=
  \begin{pmatrix}
   \lambda_1 & * &  & 0\\
     & \lambda_2 & * & \\
     &  & \ddots & *\\
   0 &  &  & \lambda_n
  \end{pmatrix}
  $$
  为$A$的Jordan形。

- 正定（半正定）分解：$A$为正定（半正定）Hermite矩阵，$A=P^HP$，$P$为可逆矩阵；

  $A=B^2$，$B$为正定Hermite矩阵。

- 乔利斯基分解：Cholesky分解，$A$为正定Hermite矩阵，$A=R^HR$，
  $$
  R=
  \begin{pmatrix}
   b_1 &  &  & *\\
     & b_2 &  & \\
     &  & \ddots & \\
   0 &  &  & b_n
  \end{pmatrix}
  $$
  为上三角矩阵。当$A$为实矩阵时，也称LU分解或LLT分解，L为下三角阵，U为上三角阵，为L的转置。

### 奇异值

给定矩阵$A=A_{m\times n}$，则$A^HA$与$AA^H$有相同的特征根$\lambda_1\ge\lambda_2\ge\cdots\ge\lambda_r>0$，其中$r=r(A)$，

那么$\sqrt{\lambda_1},\sqrt{\lambda_2}\cdots\sqrt{\lambda_r}$叫$A$的正奇异值。

又记为：$S_+(A)=\{s_1,s_2\cdots s_r\}=\{\sqrt{\lambda_1},\sqrt{\lambda_2}\cdots \sqrt{\lambda_r}\}$。

##### 正奇异值分解

正SVD，任意$m\times n$矩阵$A=A_{m\times n}$必有分解$(r(A)=r>0)$

$A=P\Delta Q^H$，
$$
\Delta=
\begin{pmatrix}
 \sqrt{\lambda_1} &  &  & 0\\
   & \sqrt{\lambda_2} &  & \\
   &  & \ddots & \\
 0 &  &  & \sqrt{\lambda_r}
\end{pmatrix}_{r\times r}
$$
$\sqrt{\lambda_1},\sqrt{\lambda_2}\cdots\sqrt{\lambda_n}$为正奇异值，且$P=P_{m\times r},Q=Q_{n\times r}$均为半酉阵，$P^HP=I_r=Q^HQ$。

分解方法：

1. 求$A^HA$（或$AA^H$）的特征根$\lambda(A^HA)=\{\lambda_1,\lambda_2\cdots\lambda_r,0,0\cdots0\}$

2. 求正交特征向量：$x_1\perp x_2\perp\cdots\perp x_r$使$A^HAx_1=\lambda_1x_1,\cdots,A^HAx_r=\lambda_rx_r$

3. 求$Ax_1,Ax_2\cdots Ax_r$（可证明：$Ax_1\perp Ax_2\perp\cdots\perp Ax_r$）

   令$P=(\frac{Ax_1}{|Ax_1|},\frac{Ax_2}{|Ax_2|}\cdots\frac{Ax_r}{|Ax_r|})_{m\times r},Q=(\frac{x_1}{|x_1|},\frac{x_2}{|x_2|}\cdots\frac{x_r}{|x_r|})_{n\times r}$（$P,Q$为半酉阵）

4. 可写正SVD分解
   $$
   A=P\Delta Q^H=
   P\begin{pmatrix}
    \sqrt{\lambda_1} &  &  & 0\\
      & \sqrt{\lambda_2} &  & \\
      &  & \ddots & \\
    0 &  &  & \sqrt{\lambda_r}
   \end{pmatrix}Q^H
   $$

##### 奇异值分解

SVD，任意$m\times n$矩阵$A=A_{m\times n}=WDV^H$，其中
$$
D=
\begin{pmatrix}
 \Delta & 0\\
 0 & 0
\end{pmatrix}_{m\times n},
\Delta=
\begin{pmatrix}
 \sqrt{\lambda_1} &  &  & 0\\
   & \sqrt{\lambda_2} &  & \\
   &  & \ddots & \\
 0 &  &  & \sqrt{\lambda_r}
\end{pmatrix}_{r\times r}
$$
$W=W_{m\times m},V=V_{n\times n}$为2个酉阵。

证明：已知有正SVD：$A=P\Delta Q^H$，令
$$
D=
\begin{pmatrix}
 \Delta & 0\\
 0 & 0
\end{pmatrix}_{m\times n}
$$
把$P$扩为$m$阶酉阵$W=(P,P_2)_{m\times m}$（不唯一）

把$Q$扩为$n$阶酉阵$V=(Q,Q_2)_{n\times n}$（不唯一）
$$
WDV^H=(P,P_2)
\begin{pmatrix}
 \Delta & 0\\
 0 & 0
\end{pmatrix}
(Q,Q_2)^H=(P\Delta, 0)
\begin{pmatrix}
 Q^H\\Q_2^H
\end{pmatrix}=
P\Delta Q^H=A
$$

##### 分解估计

$A=WDV^H=P\Delta Q^H$
$$
W=(P,P_2),V=(Q,Q_2),
D=\begin{pmatrix}
 \Delta & 0\\
 0 & 0
\end{pmatrix},
\Delta=
\begin{pmatrix}
 s_1 &  &  & 0\\
   & s_2 &  & \\
   &  & \ddots & \\
 0 &  &  & s_r
\end{pmatrix}
$$
令$P=(y_1,y_2\cdots y_r)$（$r$个列），$Q=(x_1,x_2\cdots x_r)$（$r$个列）
$$
A=P\Delta Q^H=
(y_1,y_2\cdots y_r)
\begin{pmatrix}
 s_1 &  &  & 0\\
   & s_2 &  & \\
   &  & \ddots & \\
 0 &  &  & s_r
\end{pmatrix}
(x_1^H,x_2^H\cdots x_r^H)\\
=s_1(y_1x_1^H)+s_2(y_2x_2^H)+\cdots+s_r(y_rx_r^H)=s_1G_1+s_2G_2+\cdots+s_rG_r
$$
其中$G_1,G_2\cdots G_r$为秩1阵，可写$s_1\ge s_2\ge\cdots\ge s_r>0$，则：
$$
A\approx s_1G_1\\
A\approx s_1G_1+s_2G_2\\
A\approx s_1G_1+s_2G_2+s_3G_3\\
\vdots
$$

------

# 2022-04-12-矩阵理论10-SVD、正规阵

### SVD

##### 低阵正SVD分解的简化

低阵：列数大于行数的矩阵，较扁平。

高阵：行数大于列数的矩阵，较瘦高。

若有正SVD：$A=P\Delta Q^H$，则有$A^H=Q\Delta P^H$为$A^H$的正SVD（$\Delta^H=\Delta$）。

Eg:求
$$
A=
\begin{pmatrix}
 1 & 1 & 0\\
 0 & 0 & 1\\
\end{pmatrix}
$$
的正SVD和SVD。

$A^HA$是$3\times 3$矩阵，计算较为复杂，可令：
$$
B=A^H=
\begin{pmatrix}
 1 & 0\\
 1 & 0\\
 0 & 1\\
\end{pmatrix}
$$
求B的正SVD：
$$
B^HB=
\begin{pmatrix}
 2 & 0\\
 0 & 1\\
\end{pmatrix}
$$
为对角阵，$\lambda_1=2,\lambda_2=1$。

取特征向量
$$
x_1=
\begin{pmatrix}
 1\\
 0\\
\end{pmatrix},
x_2=
\begin{pmatrix}
 0\\
 1\\
\end{pmatrix}
$$
正奇异值$S^+(A)=\{\sqrt{2},1\}$，
$$
\Delta=
\begin{pmatrix}
 \sqrt{2} & 0\\
 0 & 1\\
\end{pmatrix}
$$

$$
P=(\frac{Bx_1}{|Bx_1|},\frac{Bx_2}{|Bx_2|})=
\begin{pmatrix}
 \frac{1}{\sqrt{2}} & 0\\
 \frac{1}{\sqrt{2}} & 0\\
 0 & 1\\
\end{pmatrix}
$$

$$
Q=(\frac{x_1}{|x_1|},\frac{x_2}{|x_2|})=
\begin{pmatrix}
 1 & 0\\
 0 & 1\\
\end{pmatrix}
$$

得到正SVD：
$$
B=P\Delta Q^H=
\begin{pmatrix}
 \frac{1}{\sqrt{2}} & 0\\
 \frac{1}{\sqrt{2}} & 0\\
 0 & 1\\
\end{pmatrix}
\begin{pmatrix}
 \sqrt{2} & 0\\
 0 & 1\\
\end{pmatrix}
\begin{pmatrix}
 1 & 0\\
 0 & 1\\
\end{pmatrix}
$$

$$
A=B^H=Q\Delta P^H=
\begin{pmatrix}
 1 & 0\\
 0 & 1\\
\end{pmatrix}
\begin{pmatrix}
 \sqrt{2} & 0\\
 0 & 1\\
\end{pmatrix}
\begin{pmatrix}
 \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0\\
 0 & 0 &1\\
\end{pmatrix}
$$

扩大为SVD：
$$
W=
\begin{pmatrix}
 1 & 0\\
 0 & 1\\
\end{pmatrix},
D=
\begin{pmatrix}
 \sqrt{2} & 0 & 0\\
 0 & 1 & 0\\
\end{pmatrix},
V=
\begin{pmatrix}
 \frac{1}{\sqrt{2}} & 0 & \frac{1}{\sqrt{2}}\\
 \frac{1}{\sqrt{2}} & 0 & -\frac{1}{\sqrt{2}}\\
 0 & 1 & 0\\
\end{pmatrix}
$$

$$
A=WDV^H=
\begin{pmatrix}
 1 & 0\\
 0 & 1\\
\end{pmatrix}
\begin{pmatrix}
 \sqrt{2} & 0 & 0\\
 0 & 1 & 0\\
\end{pmatrix}
\begin{pmatrix}
 \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0\\
 0 & 0 &1\\
 \frac{1}{\sqrt{2}} & -\frac{1}{\sqrt{2}} & 0\\
\end{pmatrix}
$$

##### 正奇异值性质

若$A$为$n$阶可逆阵，$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\},S_+(A)=\{s_1,s_2\cdots s_n\}$，则：$s_1s_2\cdots s_n=|\lambda_1\lambda_2\cdots\lambda_n|$。

证明：$det(A)=\lambda_1\lambda_2\cdots\lambda_n$

$det(A^HA)=det(A^H)det(A)=det(A)^2=(\lambda_1\lambda_2\cdots\lambda_n)^2$

$det(A^HA)=s_1^2s_2^2\cdots s_n^2$

故$s_1s_2\cdots s_n=|\lambda_1\lambda_2\cdots\lambda_n|$。

设$A=A_{m\times n}\in\mathbb{C}^{m\times n},rank(A)=r>0,S_+(A)=\{s_1,s_2\cdots s_r\}$，

则$s_1^2+s_2^2+\cdots+s_r^2=tr(A^HA)=\sum|a_{ij}|^2$

证明：可设$\lambda(A^HA)={\lambda_1,\lambda_2\cdots\lambda_r,0,0\cdots 0}$

正奇异值$S^+(A)=\{s_1,s_2\cdots s_r\}=\{\sqrt{\lambda_1},\sqrt{\lambda_2}\cdots \sqrt{\lambda_r}\}$

$s_1^2+s_2^2+\cdots+s_r^2=\lambda_1+\lambda_2+\cdots+\lambda_r=tr(A^HA)$。

### 正规阵

##### 正规阵的定义

$A$为$n$阶方阵，若$A^HA=AA^H$，则称$A$为正规阵。

##### 常见的正规阵

1. 对角阵
2. Hermite阵
3. 斜Hermite阵（$A^H=-A$）
4. 酉阵

##### 正规阵的性质

1. $A$正规$\Leftrightarrow$$A^H$正规
2. 若$A$正规$\Rightarrow$$kA$正规
3. 若$A$正规$\Rightarrow$$A\pm cI$正规
4. $A$正规$\Leftrightarrow$$Q^HAQ$正规（$Q$为酉阵），即酉相似保持正规性

##### 常见的非正规阵

严格三角阵非正规。

证明：首先证明2阶严格上三角阵非正规：设
$$
B=
\begin{pmatrix}
 b & c\\
 0 & d\\
\end{pmatrix}
$$
为严格上三角阵，则
$$
B^H=
\begin{pmatrix}
 \overline{b} & 0\\
 \overline{c} & \overline{d}\\
\end{pmatrix},
B^HB=
\begin{pmatrix}
 |b|^2 & \overline{b}c\\
 b\overline{c} & |c|^2+|d|^2\\
\end{pmatrix},
BB^H=
\begin{pmatrix}
 |b|^2+|c|^2 & c\overline{d}\\
 \overline{c}d & |d|^2\\
\end{pmatrix}
$$
要使$B^HB=BB^H$，必须使$c=0$。

引理：若分块矩阵
$$
A=
\begin{pmatrix}
 B & C\\
 \boldsymbol{0} & D\\
\end{pmatrix}
$$
正规（$B,D$均为方阵），则$C=\boldsymbol{0}$且$B,D$正规。

证明：
$$
A^H=
\begin{pmatrix}
 B^H & \boldsymbol{0}\\
 C^H & D^H\\
\end{pmatrix},
A^HA=
\begin{pmatrix}
 B^HB & B^HC\\
 C^HB & C^HC+D^HD\\
\end{pmatrix},
AA^H=
\begin{pmatrix}
 BB^H+CC^H & CD^H\\
 D^HC & DD^H\\
\end{pmatrix}
$$
由条件：$AA^H=A^HA$，可推出$B^HB=BB^H+CC^H$，两边取迹，而$tr(B^HB)=tr(BB^H)$，

故$tr(CC^H)=0$，故$C=\boldsymbol{0}$，将$C=\boldsymbol{0}$代入$AA^H=A^HA$中可以得到$BB^H=B^HB,DD^H=D^HD$，故$B,D$正规。

据此引理递推可将$n$阶严格上三角阵推到2阶严格上三角阵；下三角阵同理。

##### 正规分解公式

若$A=A_{n\times n}=\mathbb{C}^{n\times n}$正规，则存在酉阵$Q$使得：
$$
Q^HAQ=Q^{-1}AQ=D=
\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
且$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$。

正规分解公式与Hermite分解公式形式相同，但条件由Hermite阵放宽为正规阵。

证明：由许尔公式：存在酉阵$Q$使得
$$
Q^HAQ=Q^{-1}AQ=D=
\begin{pmatrix}
 \lambda_1 &  &  & *\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
为上三角，由$A$正规可以推出$D$正规，故$*=\boldsymbol{0}$，$D$为对角阵。

推论：正规阵$A\in\mathbb{C}^{n\times n}$必有$n$个正交特征向量$x_1\perp x_2\perp\cdots\perp x_n$。

由相似可以得出$Q$中的列$(x_1,x_2\cdots x_n)$是$A$中$n$个无关的特征向量，又由酉阵得出正交。

------

# 2022-04-14-矩阵理论11-镜面阵、高低分解

### 镜面阵

##### 镜面阵的定义

$n$阶方阵$A=A_{n\times n}=\mathbb{C}^{n\times n}$，若$A=I_n-\frac{2xx^H}{|x|^2},x\in\mathbb{C}^n$，则称$A$为镜面阵，$x$为镜面的法向量。

##### 镜面阵的性质

1. $Ax=-x$

2. 若$y\perp x$，则$Ay=y$

   证明：若$y\perp x$，则内积$(y,x)=x^Hy=0$，

   $Ay=(I-\frac{2xx^H}{|x|^2})y=y-\frac{2x(x^Hy)}{|x|^2}=y-0=y$

3. $A^{-1}=A=A^H$，即$A$为Hermite酉阵

4. $\lambda(A)=\{-1,1\cdots 1\}$（$n-1$个1），其中-1对应特征向量$x$，1对应与特征向量$x$垂直的特征向量$y$

   证明：$A-I=-\frac{2}{|x|^2}xx^H$为秩1阵，

   $\lambda(xx^H)=\{tr(xx^H),0\cdots 0\}=\{|x|^2,0\cdots 0\}$，故$\lambda(A-I)=\{-2,0\cdots 0\}$，

   $\lambda(A)=\{-1,1\cdots 1\}$

5. 镜面阵是正规阵，可取$Q=(\frac{x}{|x|},\frac{y_1}{|y_1|},\frac{y_2}{|y_2|}\cdots\frac{y_n}{|y_n|})$为酉阵，使得
   $$
   Q^HAQ=Q^{-1}AQ=D=
   \begin{pmatrix}
    -1 &  &  & 0\\
      & 1 &  & \\
      &  & \ddots & \\
    0 &  &  & 1
   \end{pmatrix}
   $$

### 高低分解

又称满秩分解，最大秩分解。

令$m\times n$阵$A=A_{m\times n},rank(A)=r>0,r<m,r<n$，则有分解：

$A_{m\times n}=B_{m\times r}C_{r\times n}$使得$B$为高阵，$C$为低阵，这里的高阵、低阵为严格定义，即：

高阵：行数大于列数且列满秩。

低阵：列数大于行数且行满秩。

秩1分解是高低分解的特殊情况。

分解过程：对$A$做初等行变换，得到阶梯型如下：
$$
\begin{pmatrix}
 I_r & *\\
 \vdots & \vdots\\
 \boldsymbol{0} & \boldsymbol{0}
\end{pmatrix}
$$
取出$A$中前$r$列，记为：$\alpha_1,\alpha_2\cdots\alpha_r$，

可令$B=(\alpha_1,\alpha_2\cdots\alpha_r)_{m\times r},C=(I_r,*)_{r\times n}$，得到$A=BC$。

------

# 2022-04-19-矩阵理论12-正规谱分解

### 正规谱分解的定义

由正规分解：若$A=A_{n\times n}=\mathbb{C}^{n\times n}$正规，则存在酉阵$Q$使得：
$$
Q^HAQ=Q^{-1}AQ=D=
\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
且$\lambda(A)=\{\lambda_1,\lambda_2\cdots\lambda_n\}$。设$A$有$k$个不重复的根$\{\lambda_1,\lambda_2\cdots\lambda_k\}(k\le n)$，则：
$$
D=
\begin{pmatrix}
 \lambda_1I &  &  & 0\\
   & \lambda_2I &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_kI
\end{pmatrix}
$$
（将重复根写在一起，$I$为单位阵）。可写
$$
D=
\lambda_1
\begin{pmatrix}
 I &  &  & 0\\
   & 0 &  & \\
   &  & \ddots & \\
 0 &  &  & 0
\end{pmatrix}
+
\lambda_2
\begin{pmatrix}
 0 &  &  & 0\\
   & I &  & \\
   &  & \ddots & \\
 0 &  &  & 0
\end{pmatrix}
+\cdots+
\lambda_k
\begin{pmatrix}
 0 &  &  & 0\\
   & 0 &  & \\
   &  & \ddots & \\
 0 &  &  & I
\end{pmatrix}
=\lambda_1 D_1+\lambda_2 D_2+\cdots+\lambda_k D_k
$$
性质：

1. $D_1+D_2+\cdots+D_k=I_n$

2. $\lambda_1 D_1+\lambda_2 D_2+\cdots+\lambda_k D_k=D$

3. $D_i^2=D_i(i=1,2\cdots k)$，称为幂等性，可推广至$D_i^m=D_i(i=1,2\cdots k,\space m=1,2,3\cdots)$

   注：幂等阵：$A^2=A$，也称投影阵，性质：$A^p=A(p=1,2,3\cdots)$，$A$的特征根为1或0，即$\lambda(A)=\{1,1\cdots 1,0,0\cdots 0\}$，1的个数为$r(A)$

4. $D_iD_j=\boldsymbol{0}(i\ne j)$

5. $D_i^H=D_i(i=1,2\cdots k)$

$A=QDQ^{-1}=Q(\lambda_1 D_1+\lambda_2 D_2+\cdots+\lambda_k D_k)Q^{-1}=\lambda_1 QD_1Q^{-1}+\lambda_2 QD_2Q^{-1}+\cdots+\lambda_k QD_kQ^{-1}=\lambda_1G_1+\lambda_2G_2+\cdots+\lambda_kG_k$

把$A=\lambda_1G_1+\lambda_2G_2+\cdots+\lambda_kG_k$称为正规阵$A$的谱分解。

##### 正规谱分解公式

若正规阵$A$恰有$k$个不同根，则有谱分解$A=\lambda_1 G_1+\lambda_2 G_2+\cdots+\lambda_k G_k$，其中$G_1,G_2\cdots G_k$称为$A$的谱阵。

### 正规谱分解谱阵的性质

1. $G_1+G_2+\cdots+G_k=I$

   证明：$G_1+G_2+\cdots+G_k=QD_1Q^{-1}+QD_2Q^{-1}+\cdots+QD_kQ^{-1}=Q(D_1+D_2+\cdots+D_k)Q^{-1}=I$

2. $G_iG_j=0(i\ne j)$

   证明：$G_iG_j=QD_iQ^{-1}QD_jQ^{-1}=QD_iD_jQ^{-1}=\boldsymbol{0}$

3. $G_i^2=G_i(i=1,2\cdots k)$，幂等性，同样可推广至$G_i^m=G_i(i=1,2\cdots k,\space m=1,2,3\cdots)$

   证明：$G_iG_i=QD_iQ^{-1}QD_iQ^{-1}=QD_i^2Q^{-1}=G_i$

4. $G_i^H=G_i(i=1,2\cdots k)$

   证明：$G_i^H=(QD_iQ^{-1})^H=(Q^{-1})^HD_i^HQ^H=(Q^H)^HD_i^HQ^H=QD_iQ^{-1}=G_i$

5. $G_1,G_2\cdots G_k$的各列均为$A$的特征向量

   证明：$AG_1=(\lambda_1 G_1+\lambda_2 G_2+\cdots+\lambda_k G_k)G_1=\lambda_1G_1^2=\lambda_1G_1$

### 正规谱分解推论

$A^p$的谱分解：$A^p=\lambda_1^pG_1+\lambda_2^pG_2+\cdots+\lambda_k^pG_k(p=0,1,2\cdots)$

证明：$p=1$时即为正规谱分解，$p=2$时$A^2=(\lambda_1 G_1+\lambda_2 G_2+\cdots+\lambda_k G_k)^2=\lambda_1^2 G_1^2+\lambda_2^2 G_2^2+\cdots+\lambda_k^2 G_k^2=\lambda_1^2 G_1+\lambda_2^2 G_2+\cdots+\lambda_k^2 G_k$

类推可得$p$为其他正整数时的结论，特别地$p=0$时$\lambda_1^0 G_1+\lambda_2^0 G_2+\cdots+\lambda_k^0 G_k=G_1+G_2+\cdots+G_k=I=A^0$

$f(A)$的谱分解：$f(A)=f(\lambda_1)G_1+f(\lambda_2)G_2+\cdots+f(\lambda_k)G_k$对于一切多项式$f(x)$成立，称为$f(A)$的谱分解。

### 正规谱分解谱阵公式

设$A$正规，全体不同根为$\lambda_1,\lambda_2\cdots\lambda_k$，则$A$的各谱阵为：
$$
G_1=\frac{(A-\lambda_2I)(A-\lambda_3I)\cdots(A-\lambda_kI)}{(\lambda_1-\lambda_2)(\lambda_1-\lambda_3)\cdots(\lambda_1-\lambda_k)}\\
G_2=\frac{(A-\lambda_1I)(A-\lambda_3I)\cdots(A-\lambda_kI)}{(\lambda_2-\lambda_1)(\lambda_2-\lambda_3)\cdots(\lambda_2-\lambda_k)}\\
\vdots\\
G_k=\frac{(A-\lambda_1I)(A-\lambda_2I)\cdots(A-\lambda_{k-1}I)}{(\lambda_k-\lambda_1)(\lambda_k-\lambda_2)\cdots(\lambda_k-\lambda_{k-1})}
$$

------

# 2022-04-21-矩阵理论13-可对角阵

### 可对角阵的定义

可对角阵，也称单阵、单纯阵。

$A$为$n$阶方阵，若有可逆阵$P$使得：
$$
P^{-1}AP=D=
\begin{pmatrix}
 \lambda_1 &  &  & 0\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
为对角形，则称$A$为可对角阵。

### 可对角阵的性质

1. $P$中的列$\{x_1,x_2\cdots x_n\}$为$A$的$n$个线性无关的特征向量

2. $A^k$也是可对角阵，且和$A$有相同的特征向量
   $$
   (P^{-1}AP)^k=P^{-1}A^kP=D^k=
   \begin{pmatrix}
    \lambda_1^k &  &  & 0\\
      & \lambda_2^k &  & \\
      &  & \ddots & \\
    0 &  &  & \lambda_n^k
   \end{pmatrix}
   $$

3. 若$A$为可逆的可对角阵，且有谱分解$A=\lambda_1 G_1+\lambda_2 G_2+\cdots+\lambda_k G_k$，则$A^{-1}=\frac{1}{\lambda_1} G_1+\frac{1}{\lambda_2} G_2+\cdots+\frac{1}{\lambda_k} G_k$

### 可对角阵的判定

1. $n$阶方阵$A$为可对角阵$\Leftrightarrow$$A$有$n$个无关的特征向量$x_1,x_2\cdots x_n$
2. 若$A$有$n$个不同特征根则$A$为可对角阵，因为不同根对应的特征向量一定线性无关
3. 正规阵一定是可对角阵
4. $n$阶方阵$A$为可对角阵$\Leftrightarrow$每个$k>1$重根必有$k$个无关的特征向量
5. 对于$n$阶方阵$A$，每个$k>1$重根$\lambda_i$有$rank(A-\lambda_i)=n-k$$\Leftrightarrow$$A$为可对角阵
6. 若$\lambda_1,\lambda_2\cdots\lambda_k$为$A$的全体不同根，则$A$为可对角阵$\Leftrightarrow$$(A-\lambda_1I)(A-\lambda_2I)\cdots(A-\lambda_kI)=\boldsymbol{0}$
7. 0化式判别法：若$A$的一个0化式无重根，则$A$为可对角阵；0化式的定义：若多项式$f(x)$使$f(A)=\boldsymbol{0}$则称$f(x)$是$A$的一个0化式

### 可对角阵的谱公式

若$A$为可对角阵，全体不同根为$\lambda_1,\lambda_2\cdots\lambda_k$，则有$A=\lambda_1 G_1+\lambda_2 G_2+\cdots+\lambda_k G_k$称为$A$的谱分解，其中$G_1,G_2\cdots G_k$称为$A$的谱阵，且有：

1. $G_1+G_2+\cdots+G_k=I$

2. $G_iG_j=0(i\ne j)$
3. $G_i^2=G_i(i=1,2\cdots k)$，幂等性，同样可推广至$G_i^m=G_i(i=1,2\cdots k,\space m=1,2,3\cdots)$
4. $G_1,G_2\cdots G_k$的各列均为$A$的特征向量

谱阵公式：
$$
G_1=\frac{(A-\lambda_2I)(A-\lambda_3I)\cdots(A-\lambda_kI)}{(\lambda_1-\lambda_2)(\lambda_1-\lambda_3)\cdots(\lambda_1-\lambda_k)}\\
G_2=\frac{(A-\lambda_1I)(A-\lambda_3I)\cdots(A-\lambda_kI)}{(\lambda_2-\lambda_1)(\lambda_2-\lambda_3)\cdots(\lambda_2-\lambda_k)}\\
\vdots\\
G_k=\frac{(A-\lambda_1I)(A-\lambda_2I)\cdots(A-\lambda_{k-1}I)}{(\lambda_k-\lambda_1)(\lambda_k-\lambda_2)\cdots(\lambda_k-\lambda_{k-1})}
$$

------

# 2022-04-26-矩阵理论14-张量积

### 张量积的定义

张量积（直积）：$a_1b_1,\cdots,a_1b_j$，对于任意$A\in\mathbb{C}^{m\times n}$，$B\in\mathbb{C}^{p\times q}$有定义：$A\otimes B=(a_{ij}B)\in\mathbb{C}^{mp\times nq}$。

$A\otimes B$与$B\otimes A$有相同的阶数，但一般$A\otimes B\ne B\otimes A$，即矩阵的直积不满足交换律。

例外：$I_n\otimes I_q=I_q\otimes I_n$。

### 字典序

##### 字典序的定义

2个行$A=(a_1,a_2,\cdots a_n)_{1\times n},B=(b_1,b_2,\cdots b_q)_{1\times q}$，则
$$
A\otimes B=(a_1B,a_2B,\cdots a_nB)\\
=(a_1b_1,\cdots,a_1b_j,a_2b_1,\cdots,a_2b_j,\cdots,a_nb_1,\cdots,a_nb_j)\in\mathbb{C}^{1\times nq}
$$
为字典次序，记为$A\otimes B=\{全体a_ib_j\}$，称为字典序（同样也适用于这样的两个列）。

### 张量积的性质

1. 两个对角阵的张量积仍为对角阵。

2. 两个上三角阵的张量积仍为上三角阵，张量积的对角元为原来两个矩阵对角元的字典序。

3. 分块矩阵的张量积：
   $$
   \begin{pmatrix}
    A_{11} & A_{12} & \cdots & A_{1n}\\
    A_{21} & A_{22} & \cdots & A_{2n}\\
    \vdots & \vdots & \ddots & \vdots\\
    A_{m1} & A_{m2} & \cdots & A_{mn}
   \end{pmatrix}\otimes B=
   \begin{pmatrix}
    A_{11}\otimes B & A_{12}\otimes B & \cdots & A_{1n}\otimes B\\
    A_{21}\otimes B & A_{22}\otimes B & \cdots & A_{2n}\otimes B\\
    \vdots & \vdots & \ddots & \vdots\\
    A_{m1}\otimes B & A_{m2}\otimes B & \cdots & A_{mn}\otimes B
   \end{pmatrix}
   $$
   即左分块可以结合，但这个结论对于右分块不成立。

   注：令$A=(\alpha_1,\alpha_2,\cdots,\alpha_n)\in\mathbb{C}^{m\times n},B=(\beta_1,\beta_2,\cdots,\beta_q)\in\mathbb{C}^{p\times q}$，其中$\alpha,\beta$为各列，则：

   $A\otimes B=(\alpha_1\beta_1,\cdots,\alpha_1\beta_q,\cdots,\alpha_n\beta_1,\cdots,\alpha_n\beta_q)$，即$A\otimes B$的列为$A,B$各列的字典序。

4. 吸收公式：只要$AC$和$BD$有矩阵乘法定义，那么$(A\otimes B)(C\otimes D)=(AC)\otimes(BD)$。

   推广：只要$A_1A_2A_3$和$B_1B_2B_3$有矩阵乘法定义，那么$(A_1\otimes B_1)(A_2\otimes B_2)(A_3\otimes B_3)=(A_1A_2A_3)\otimes (B_1B_2B_3)$。

5. 秩公式：$rank(A\otimes B)=rank(A)rank(B)$。

6. 逆公式：设$A,B$分别为$m$阶与$n$阶可逆阵，则$A\otimes B$可逆，且$(A\otimes B)^{-1}=A^{-1}\otimes B^{-1}$。

7. 转置公式：$(A\otimes B)^{\top}=A^{\top}\otimes B^{\top}$且$(A\otimes B)^H=A^H\otimes B^H$。

   推论：若$A$和$B$都为酉阵，则$A\otimes B$为酉阵。

   证明：$(A\otimes B)^{-1}=A^{-1}\otimes B^{-1}=A^H\otimes B^H=(A\otimes B)^H$。

8. 若$A,B$为Hermite阵，则$A\otimes B$为Hermite阵。

9. 若$A,B$为幂等阵，则$A\otimes B$为幂等阵。

------

# 2022-04-28-矩阵理论15-张量积与特征值、矩阵拉直

### 张量积的特征值

##### 积

有两个方阵$A=A_{m\times m},B=B_{n\times n}$，则有$\lambda(A\otimes B)=\{\lambda_1t_1,\cdots,\lambda_1t_n,\cdots,\lambda_mt_1,\cdots,\lambda_mt_n\}$

其中$\lambda(A)=\{\lambda_1,\cdots,\lambda_m\},\lambda(B)=\{t_1,\cdots,t_m\}$

可写$\lambda(A\otimes B)=\{全体\lambda_it_j\}$，即字典序。

引理：张量积保持相似：若$A\sim D_1,B\sim D_2$则$A\otimes B\sim D_1\otimes D_2$

证引理：可令$P^{-1}AP=D_1,Q^{-1}BQ=D_2$，则$(P^{-1}AP)\otimes (Q^{-1}BQ)=D_1\otimes D_2$，则$(P\otimes Q)^{-1}(A\otimes B)(P\otimes Q)=D_1\otimes D_2$

证明：由许尔公式：
$$
A\sim D_1=
\begin{pmatrix}
 \lambda_1 &  &  & *\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_m
\end{pmatrix},
B\sim D_2=
\begin{pmatrix}
 \lambda_1 &  &  & *\\
   & \lambda_2 &  & \\
   &  & \ddots & \\
 0 &  &  & \lambda_n
\end{pmatrix}
$$
由引理可得$A\otimes B\sim D_1\otimes D_2$，因此$\lambda(A\otimes B)=\lambda(D_1\otimes D_2)=\{全体\lambda_it_j\}$（字典序）共$m\times n$个。

##### 和

2个方阵$A=A_{m\times m},B=B_{n\times n}$，则有

$\lambda(A\otimes I_n\pm I_m\otimes B)=\{全体\lambda_i\pm t_j\}$（字典序）共$m\times n$个。

证明：由许尔公式$A\sim D_1,B\sim D_2$（$D_1,D_2$均为上三角）

则$A\otimes I_n+I_m\otimes B\sim D_1\otimes I_n+I_m\otimes D_2$，展开$D_1\otimes I_n+I_m\otimes D_2$矩阵即可得到结论。

##### 其他性质

1. $\lambda(A^{\top})=\lambda(A)=\{\lambda_1\cdots\lambda_m\},\lambda(B^{\top})=\lambda(B)=\{t_1\cdots t_n\}$

2. $\lambda(A\otimes B^{\top})=\lambda(A^{\top}\otimes B)=\lambda(A^{\top}\otimes B^{\top})=\lambda(A\otimes B)$

3. $\lambda(A\otimes I_n\pm I_m\otimes B^{\top})=\lambda(A^{\top}\otimes I_n\pm I_m\otimes B)=\lambda(A^{\top}\otimes I_n\pm I_m\otimes B^{\top})=\lambda(A\otimes I_n\pm I_m\otimes B)$

4. 设2个方阵$A=A_{m\times m},B=B_{n\times n}$分别有特征向量：

   $\{x_1,x_2,\cdots,x_m\}$和$\{y_1,y_2,\cdots,y_n\}$

   则$A\otimes B$的特征向量为：$\{x_1\otimes y_1,\cdots,x_1\otimes y_n,\cdots,x_m\otimes y_1,\cdots,x_m\otimes y_n\}$。

   证明：已知$Ax_1=\lambda_1 x_1,By_1=t_1 y_1$，则

   $(A\otimes B)(x_1\otimes y_1)=(Ax_1)\otimes(By_1)=\lambda_1 x_1\otimes t_1y_1=\lambda_1 t_1(x_1\otimes y_1)$

5. 迹公式：$traj(A\otimes B)=traj(A)traj(B)$

6. 行列式公式：$det(A\otimes B)=det(A)^ndet(B)^m$，$A=A_{m\times m},B=B_{n\times n}$

   证明：令$\lambda(A)=\{\lambda_1,\cdots,\lambda_m\},\lambda(B)=\{t_1,\cdots,t_m\}$

   则$det(A)=\lambda_1\lambda_2\cdots\lambda_m,det(B)=t_1 t_2\cdots t_n$

   而$\lambda(A\otimes B)=\{全体\lambda_it_j\}$（字典序）

   行列式为全体特征值的乘积，故$det(A\otimes B)=det(A)^ndet(B)^m$

### 矩阵拉直

##### 矩阵拉直的定义

令$A=(a_{ij})\in\mathbb{C}^{m\times n}$，规定$A$的按行拉直是一个列向量：

$\overrightarrow{A}=(a_{11},a_{12},\cdots,a_{1n},a_{11},a_{22},\cdots,a_{2n},\cdots,a_{m1},a_{m2},\cdots,a_{mn})^{\top}$

引理：设$A=(a_{ij})\in\mathbb{C}^{m\times n}$，记$A$的$m$个行为$A_1,A_2,\cdots,A_m$，则有

$A=\begin{pmatrix}A_1\\\vdots\\A_m\\\end{pmatrix}$（按行分块），且$\overrightarrow{A}=(A_1,A_2,\cdots,A_m)^{\top}=\begin{pmatrix}A_1^{\top}\\\vdots\\A_m^{\top}\\\end{pmatrix}\in\mathbb{C}^{m\times n}$

拉直$\overrightarrow{\space\space\space\space\space}$是$\mathbb{C}^{m\times n}$与$\mathbb{C}^{mn}$之间的一一对应。

##### 矩阵拉直的性质

1. $\overrightarrow{(A\pm B)}=\overrightarrow{A}\pm\overrightarrow{B}$
2. $\overrightarrow{(kA)}=k(\overrightarrow{A})$
3. 设$X=X(t)\in\mathbb{C}^{m\times n}$，则$\frac{\overrightarrow{dX}}{dt}=\frac{d}{dt}\overrightarrow{X}$

##### 三项拉直公式

只要$ABC$有矩阵乘法定义，$\overrightarrow{ABC}=(A\otimes C^{\top})\overrightarrow{B}$

推论：设$A=(a_{ij})_{m\times m},X=(x_{ij})_{m\times n},B=(b_{ij})_{n\times n}$，则有：

1. $\overrightarrow{AX}=(A\otimes I_n)\overrightarrow{X},\overrightarrow{XB}=({I_m}\otimes B^{\top})\overrightarrow{X}$
2. $\overrightarrow{AX+XB}=(A\otimes I_n+I_m\otimes B^{\top})\overrightarrow{X}$

------

# 2022-05-05-矩阵理论16-线上自学

由于疫情原因，此后课程改为线上自学，内容如下：

|  上课时间  |              主要内容              |    对应赵迪老师所发的pdf    |
| :--------: | :--------------------------------: | :-------------------------: |
| 2022-05-05 |        矩阵理论16-矩阵函数         |        矩阵函数.pdf         |
| 2022-05-10 | 矩阵理论17-幂0阵、若当块与矩阵函数 | 幂0阵、若当块与矩阵函数.pdf |
| 2022-05-12 |     矩阵理论18-求导公式与应用      |     求导公式与应用.pdf      |
| 2022-05-17 |        矩阵理论19-广谱公式         |        广谱公式.pdf         |
| 2022-05-19 |        矩阵理论20-矩阵范数1        |        矩阵范数1.pdf        |
| 2022-05-24 |        矩阵理论21-矩阵范数2        | 范数理论2-圆盘-许尔估计.pdf |
| 2022-05-26 |         矩阵理论22-广义逆1         |         广义逆1.pdf         |
| 2022-05-31 |         矩阵理论23-广义逆2         |     广义逆2-高低阵.pdf      |
| 2022-06-02 |         矩阵理论24-总复习          |  复习考题.pdf+复习答案.pdf  |
